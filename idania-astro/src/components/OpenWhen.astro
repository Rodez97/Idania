---
// Cartas interactivas "Abre Cuando..."
const letters = [
    {
        id: 1,
        title: "Abre cuando te sientas triste",
        icon: "cloud-rain",
        color: "#87ceeb",
        message: "Idania, sé que a veces los días pueden ser difíciles, pero quiero que sepas que eres una de las personas más fuertes que conozco. Tu sonrisa ilumina cualquier lugar, y aunque ahora no te sientas así, recuerda que esto es temporal. Eres increíble, valiosa, y mereces toda la felicidad del mundo. Estoy aquí para ti, siempre. Cuando te sientas mejor, quiero ser el primero en ver esa hermosa sonrisa tuya de nuevo. Te mando todo mi cariño ♡"
    },
    {
        id: 2,
        title: "Abre cuando me extrañes",
        icon: "heart",
        color: "#ff6b9d",
        message: "Yo también te extraño, muchísimo. Pienso en ti más de lo que imaginas. Pienso en tu risa, en cómo tus ojos brillan cuando hablas de algo que te apasiona, en cómo me haces sentir cuando estamos juntos. La distancia es dura, pero cada momento contigo vale toda la espera. Pronto estaremos juntos de nuevo, y será increíble. Mientras tanto, recuerda que aunque no esté físicamente ahí, siempre estás en mis pensamientos. Cuenta los días conmigo ♡"
    },
    {
        id: 3,
        title: "Abre cuando necesites sonreír",
        icon: "smile",
        color: "#ffd700",
        message: "¿Sabías que tu risa es mi sonido favorito? Cada vez que te ríes, especialmente esa risa espontánea que tienes, no puedo evitar sonreír también. Eres divertida, ingeniosa, y tienes un sentido del humor que me encanta. Me encanta cómo nos reímos juntos de las cosas más tontas, cómo una simple mirada ya nos hace reír. No puedo esperar a hacerte reír de nuevo. Mientras tanto, imagina que estoy ahí contigo, haciendo alguna tontería para sacarte una sonrisa. Porque verte feliz es lo que más me gusta en el mundo ♡"
    },
    {
        id: 4,
        title: "Abre cuando quieras recordar por qué te quiero",
        icon: "sparkles",
        color: "#ff69b4",
        message: "Te quiero por tantas razones que podría escribir un libro. Te quiero por tu autenticidad, por cómo eres tú misma sin pretensiones. Por tu inteligencia y las conversaciones increíbles que tenemos. Por tu risa contagiosa y tu energía. Por cómo me haces sentir especial. Por tu bondad, tu fuerza, tu forma de ver la vida. Te quiero por cómo tus ojos brillan cuando hablas de lo que te apasiona. Te quiero en tus días buenos y en los no tan buenos. Te quiero por ser exactamente quien eres, Idania. Y cada día descubro nuevas razones para quererte más ♡"
    },
    {
        id: 5,
        title: "Abre cuando necesites motivación",
        icon: "zap",
        color: "#ff8c00",
        message: "Idania, eres capaz de lograr todo lo que te propongas. He visto tu determinación, tu inteligencia, y tu fuerza. No dejes que nada ni nadie te haga dudar de ti misma. Eres increíble, talentosa, y tienes un potencial enorme. Lo que sea que estés enfrentando ahora, sé que puedes superarlo. Confío en ti completamente. Ve y conquista el mundo, hermosa. Estaré aquí celebrando cada uno de tus logros y apoyándote en cada paso. ¡Tú puedes con esto y con mucho más! ♡"
    },
    {
        id: 6,
        title: "Abre cuando te sientas insegura",
        icon: "shield",
        color: "#9370db",
        message: "Escúchame bien: eres hermosa. Eres inteligente. Eres valiosa. Eres suficiente. No por lo que haces o lo que logras, sino por quien eres. Tus 'imperfecciones' son lo que te hace única y real. Me gustas exactamente como eres. No necesitas cambiar nada. Cuando te miro, veo a una mujer increíble, auténtica, fuerte y hermosa. No dejes que las dudas te hagan olvidar lo especial que eres. Porque yo lo veo claramente, y no soy el único. Cree en ti tanto como yo creo en ti ♡"
    }
];
---

<div class="open-when-container">
    <p class="intro-text">
        Escribí estas cartas para ti, para diferentes momentos. Ábrelas cuando las necesites.
        Cada una tiene un mensaje especial esperándote ♡
    </p>

    <div class="letters-grid">
        {letters.map((letter) => (
            <div class="letter-card" data-letter-id={letter.id}>
                <div class="envelope" style={`--envelope-color: ${letter.color}`}>
                    <div class="envelope-front">
                        <div class="envelope-icon">
                            <i data-lucide={letter.icon}></i>
                        </div>
                        <h3>{letter.title}</h3>
                        <p class="tap-hint">Click para abrir</p>
                    </div>
                    <div class="envelope-back">
                        <button class="close-btn" aria-label="Cerrar carta">
                            <i data-lucide="x"></i>
                        </button>
                        <div class="message-content">
                            <p>{letter.message}</p>
                        </div>
                    </div>
                </div>
            </div>
        ))}
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', () => {
        const letterCards = document.querySelectorAll('.letter-card');

        letterCards.forEach(card => {
            const envelope = card.querySelector('.envelope');
            const closeBtn = card.querySelector('.close-btn');

            envelope.addEventListener('click', (e) => {
                if (!e.target.closest('.close-btn')) {
                    envelope.classList.add('opened');
                }
            });

            closeBtn?.addEventListener('click', (e) => {
                e.stopPropagation();
                envelope.classList.remove('opened');
            });
        });

        // Re-inicializar iconos de Lucide
        if (typeof lucide !== 'undefined' && lucide.createIcons) {
            lucide.createIcons();
        }
    });
</script>

<style>
    .open-when-container {
        margin: 40px 0;
    }

    .intro-text {
        font-size: 1.15em;
        line-height: 1.8;
        color: #555;
        text-align: center;
        margin: 30px auto;
        max-width: 700px;
        font-style: italic;
    }

    .letters-grid {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 25px;
        margin: 50px 0;
        max-width: 1000px;
        margin-left: auto;
        margin-right: auto;
    }

    .letter-card {
        perspective: 1000px;
        height: 100%;
    }

    .envelope {
        position: relative;
        width: 100%;
        height: 100%;
        min-height: 220px;
        transform-style: preserve-3d;
        transition: transform 0.6s;
        cursor: pointer;
    }

    .envelope-front,
    .envelope-back {
        position: absolute;
        width: 100%;
        height: 100%;
        backface-visibility: hidden;
        border-radius: 15px;
        padding: 25px;
        display: flex;
        flex-direction: column;
    }

    .envelope-front {
        background: linear-gradient(135deg, var(--envelope-color), rgba(255, 255, 255, 0.9));
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        align-items: center;
        justify-content: center;
        border: 3px solid white;
    }

    .envelope-icon {
        width: 60px;
        height: 60px;
        background: white;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        margin-bottom: 15px;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
    }

    .envelope-icon :global(svg) {
        width: 30px;
        height: 30px;
        color: var(--envelope-color);
    }

    .envelope-front h3 {
        font-family: 'Playfair Display', serif;
        font-size: 1.2em;
        color: #333;
        text-align: center;
        margin: 10px 0;
        line-height: 1.3;
        max-width: 100%;
    }

    .tap-hint {
        font-size: 0.85em;
        color: #666;
        font-style: italic;
        margin-top: 8px;
    }

    .envelope-back {
        background: white;
        box-shadow: 0 15px 40px rgba(0, 0, 0, 0.3);
        transform: rotateY(180deg);
        border: 3px solid var(--envelope-color);
        position: relative;
        justify-content: flex-start;
    }

    .envelope.opened {
        transform: rotateY(180deg);
    }

    .close-btn {
        position: absolute;
        top: 10px;
        right: 10px;
        background: var(--envelope-color);
        border: none;
        width: 35px;
        height: 35px;
        border-radius: 50%;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: all 0.3s ease;
        z-index: 10;
    }

    .close-btn:hover {
        transform: scale(1.1);
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
    }

    .close-btn :global(svg) {
        width: 20px;
        height: 20px;
        color: white;
    }

    .message-content {
        font-size: 0.95em;
        line-height: 1.7;
        color: #444;
        text-align: justify;
        padding: 5px 0;
        overflow-y: auto;
        flex: 1;
    }

    .message-content p {
        margin: 0;
    }

    @media (max-width: 1024px) {
        .letters-grid {
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
        }
    }

    @media (max-width: 768px) {
        .letters-grid {
            grid-template-columns: 1fr;
            gap: 20px;
            max-width: 400px;
        }

        .envelope {
            min-height: 200px;
        }

        .envelope-front,
        .envelope-back {
            padding: 20px;
        }

        .envelope-front h3 {
            font-size: 1.1em;
        }

        .envelope-icon {
            width: 50px;
            height: 50px;
        }

        .envelope-icon :global(svg) {
            width: 25px;
            height: 25px;
        }

        .message-content {
            font-size: 0.9em;
            line-height: 1.6;
        }
    }
</style>
